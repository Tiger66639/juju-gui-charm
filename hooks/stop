#!/usr/bin/env python2

from charmhelpers import (
    get_config,
    log,
    log_entry,
    log_exit,
    service_control,
    STOP,
)
from shelltoolbox import su


def stop():
    """Stop the Juju API agent."""
    config = get_config()
    with su('root'):
        log('Stopping Juju GUI.')
        service_control('juju-gui', STOP)
        if config.get('staging'):
            log('Stopping the staging backend.')
            service_control('juju-api-improv', STOP)
        else:
            log('Stopping API agent.')
            service_control('juju-api-agent', STOP)


if __name__ == '__main__':
    log_entry()
    try:
        stop()
    finally:
        log_exit()
